<div class="card bg-base-100 shadow-sm border border-base-300 mt-8 p-6 rounded-xl">
  <div class="comments-header">
    <h3 class="text-xl font-bold text-base-content">
      Comments ({{ comments().length }})
    </h3>
  </div>

  <!-- New Comment Form -->
  <div class="mb-8">
    <label class="label mb-2">
      <span class="label-text font-semibold">Add a Comment</span>
    </label>
    <form [formGroup]="commentForm" (ngSubmit)="submitComment()" class="flex flex-col gap-2">
      <div class="join w-full">
        <div class="flex-1">
          <label class="input validator join-item w-full">
            <input type="text" placeholder="Share your thoughts..." required formControlName="message" class="w-full"/>
          </label>
        </div>
        <button
          type="submit"
          class="btn btn-primary join-item flex-shrink-0"
          [disabled]="isSubmitting()">
          @if (isSubmitting()) {
            <span class="loading loading-spinner loading-sm"></span>
          } @else {
            Comment
          }
        </button>
      </div>
    </form>
  </div>

  <!-- Comments List -->
  <div class="comments-list">
    @if (isLoading()) {
      <div class="loading-state">
        <span class="loading loading-spinner loading-md"></span>
        <p class="text-base-content/70">Loading comments...</p>
      </div>
    } @else if (comments().length === 0) {
      <div class="empty-state">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-base-content/30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
        <p class="text-base-content/70">No comments yet. Be the first to share your thoughts!</p>
      </div>
    } @else {
      <div class="comments-container">
        @for (comment of comments(); track comment.id) {
          <app-comment
            [comment]="comment"
            [postId]="postId"
            (commentUpdated)="onCommentUpdated()"
            (commentDeleted)="onCommentDeleted()">
          </app-comment>
        }
      </div>
    }
  </div>
</div>
