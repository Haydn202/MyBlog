<div class="card bg-base-100 shadow-sm border border-base-300 mt-8 p-6 rounded-xl">
  <div class="comments-header">
    <h3 class="text-xl font-bold text-base-content">
      Comments ({{ comments().length }})
    </h3>
  </div>
  
  <!-- New Comment Form -->
  <div class="card bg-base-200 shadow-sm border border-base-300 mb-8 p-6 rounded-lg">
    <form [formGroup]="commentForm" (ngSubmit)="submitComment()">
      <div class="form-control">
        <label class="label">
          <span class="label-text font-semibold">Add a Comment</span>
        </label>
        <textarea
          formControlName="message"
          class="textarea textarea-bordered w-full"
          rows="4"
          placeholder="Share your thoughts..."></textarea>
        @if (commentForm.get('message')?.invalid && commentForm.get('message')?.touched) {
          <label class="label">
            <span class="label-text-alt text-error">
              Comment must be between 1 and 1000 characters
            </span>
          </label>
        }
      </div>
      
      <div class="form-actions">
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="commentForm.invalid || isSubmitting()">
          @if (isSubmitting()) {
            <span class="loading loading-spinner loading-sm"></span>
            Posting...
          } @else {
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
            </svg>
            Post Comment
          }
        </button>
      </div>
    </form>
  </div>
  
  <!-- Comments List -->
  <div class="comments-list">
    @if (isLoading()) {
      <div class="loading-state">
        <span class="loading loading-spinner loading-md"></span>
        <p class="text-base-content/70">Loading comments...</p>
      </div>
    } @else if (comments().length === 0) {
      <div class="empty-state">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-base-content/30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
        <p class="text-base-content/70">No comments yet. Be the first to share your thoughts!</p>
      </div>
    } @else {
      <div class="comments-container">
        @for (comment of comments(); track comment.id) {
          <app-comment 
            [comment]="comment" 
            [postId]="postId"
            (commentUpdated)="onCommentUpdated()"
            (commentDeleted)="onCommentDeleted()">
          </app-comment>
        }
      </div>
    }
  </div>
</div>
